import azure.functions as func
import logging

app = func.FunctionApp(http_auth_level=func.AuthLevel.FUNCTION)

@app.route(route="uploadWeight")
def uploadWeight(req: func.HttpRequest) -> func.HttpResponse:
    logging.info('test')
    #logging.info('Python HTTP trigger function processed a request.')
    #patientID = req.params.get('PatientID')
    #dateTimeTaken = req.params.get('DateTimeTaken')
    #weightInPounds = req.params.get('WeightInPounds') 
    #ifManualInput = req.params.get('IfManualInput')
    try:
        req_body = req.get_json()
        # Get PatientID and Check it is correct
        patientID = req_body.get('patientID')
        logging.info(type(patientID)) 
        if not patientID:
            return func.HttpResponse(
                "No PatientID Specificed",
                status_code = 400
            )
        dateTimeTaken = req_body.get('DateTimeTaken')
        if not dateTimeTaken:
            return func.HttpResponse(
                "No DateTimeTaken Specificed",
                status_code = 400
            )

        weightInPounds = req_body.get('WeightInPounds')
        if not weightInPounds:
            return func.HttpResponse(
                "No WeightInPound Specificed",
                status_code = 400
            )

        ifManualInput = req_body.get('IfManualInput')
        if not ifManualInput:
            return func.HttpResponse(
                "No IfManualInput Specificed",
                status_code = 400
            )
        #
        return func.HttpResponse(
            "Successful",
            status_code=200
        )
    except ValueError:
        return func.HttpResponse(
            "Something Went Wrong",
            status_code = 400
        )

        )